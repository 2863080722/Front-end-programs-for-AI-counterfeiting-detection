(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[7],{134:function(e,t,n){"use strict";n.r(t);var i,a,o=n(2),r=n(5),c=n(13),l=n(34),s=n(25),p=n(47),h=n(4),u=n.n(h),g=n(8),x=n(26),d=n(35),f=n.n(d),b=n(36),m=n(40),j=n(63),O=n(32),w=n(28),y=n(17),v=n(16),k="https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0",F=function(){var e,t=Object(g["useState"])({url:k}),n=Object(s["a"])(t,2),o=n[0],p=n[1],h=Object(g["useState"])(void 0),d=Object(s["a"])(h,2),F=d[0],S=d[1],C=x["a"].getAccountId();Object(g["useEffect"])((function(){var e,t,n=f()(i||(i=Object(l["a"])(["\n          query GetUserInfo {\n            account( where: { _and: [ "," ] }   limit: 1){\n              __typename\n              id \n              profile_image {\n                id\n                url\n              }\n              username\n            }\n          }\n        "])),Object(m["a"])("id","_eq",C));b["a"].query({query:n,variables:{}},{onSuccess:function(t){return(e=e||Object(c["a"])(Object(r["a"])().mark((function e(t){var n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.data.account,n.length?(i=n[0],i.profile_image&&(i.profile_image.id&&i.profile_image.url?p(i.profile_image):u.a.showToast({title:"\u7528\u6237\u5934\u50cf\u6570\u636e\u9519\u8bef",duration:1500,icon:"none"})),i.username&&S(i.username)):u.a.showToast({title:"\u7528\u6237\u4fe1\u606f\u67e5\u8be2\u8bf7\u6c42\u7ed3\u679c\u9519\u8bef",duration:1500,icon:"none"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onFailure:function(){return(t=t||Object(c["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:u.a.showToast({title:"\u7528\u6237\u4fe1\u606f\u67e5\u8be2\u8bf7\u6c42\u5931\u8d25",duration:1500,icon:"none"});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}})}),[]);var T=function(t){return(e=e||Object(c["a"])(Object(r["a"])().mark((function e(t){var n,i,a,o,c,l,s,h;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(u.a.showLoading(),null===(n=t.detail)||void 0===n||!n.avatarUrl||null===(i=t.detail)||void 0===i||!i.avatarUrl.length){e.next=12;break}return o=null===(a=t.detail)||void 0===a?void 0:a.avatarUrl,e.next=5,u.a.getFileInfo({filePath:o});case 5:return c=e.sent,l=o.substring(o.lastIndexOf(".")+1).toUpperCase(),s=Object(j["a"])(o,l,c.digest,!1),e.next=10,s;case 10:h=e.sent,p({id:h.id,url:h.url});case 12:u.a.hideLoading();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)},I=function(e){if(o.id&&e){var t,n,i=f()(a||(a=Object(l["a"])(['\n            mutation UpdateUserInfo {\n              update_account(_set: { username: "','",\n              profile_image_id: '," }, where: { id: { _eq: "," } }) {\n                affected_rows\n                returning {\n                  id\n                }\n              }\n            }\n          "])),e,o.id,C);b["a"].mutate({mutation:i,variables:{}},{onSuccess:function(){return(t=t||Object(c["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:w["a"].emit("navigation_go-back",!1),O["a"].onPersonalInfoSettingSuccess&&setTimeout(Object(c["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].onPersonalInfoSettingSuccess();case 2:O["a"].onPersonalInfoSettingSuccess=null;case 3:case"end":return e.stop()}}),e)}))),100);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onFailure:function(){return(n=n||Object(c["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:u.a.showToast({title:"\u4fee\u6539\u7528\u6237\u4fe1\u606f\u5931\u8d25",duration:1500,icon:"none"});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}})}else u.a.showToast({title:"\u8bf7\u586b\u5165\u5934\u50cf\u548c\u6635\u79f0",duration:1500,icon:"none"})},_=function(){w["a"].emit("navigation_go-back",!1)};return Object(v["jsxs"])(y["c"],{style:{width:"100vw",height:"100vh",backgroundColor:"white"},onSubmit:function(e){var t,n;S(null===(t=e.detail.value)||void 0===t?void 0:t.nickname),I(null===(n=e.detail.value)||void 0===n?void 0:n.nickname)},children:[Object(v["jsx"])(y["h"],{style:{marginTop:"108px",marginLeft:"24px",fontStyle:"normal",fontWeight:600,fontSize:"24px",lineHeight:"28px",color:"#303030"},children:"\u83b7\u53d6\u4f60\u7684\u5934\u50cf\u3001\u6635\u79f0"}),Object(v["jsx"])(y["h"],{style:{marginTop:"12px",marginLeft:"24px",marginRight:"65px",fontStyle:"normal",fontWeight:400,fontSize:"12px",lineHeight:"20px",color:"#303030",opacity:"0.5"},children:"\u83b7\u53d6\u7528\u6237\u5934\u50cf\u3001\u6635\u79f0\uff0c\u4e3b\u8981\u7528\u4e8e\u5411\u7528\u6237\u63d0\u4f9b\u5177\u6709\u8fa8\u8bc6\u5ea6\u7684\u7528\u6237\u4e2d\u5fc3\u754c\u9762\u3002"}),Object(v["jsx"])(y["h"],{style:{marginTop:"48px",marginLeft:"24px",marginRight:"24px",height:"1px",backgroundColor:"#F5F5F5"}}),Object(v["jsxs"])(y["h"],{style:{marginTop:"14px",marginLeft:"24px",marginRight:"30px",height:"44px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(v["jsxs"])(y["h"],{style:{width:"100px",height:"44px",display:"flex",alignItems:"center"},children:[Object(v["jsx"])(y["h"],{style:{height:"20px",fontWeight:400,fontSize:"14px",lineHeight:"20px",color:"#303030",display:"inline-block"},children:"\u5934\u50cf"}),Object(v["jsx"])(y["d"],{src:o.url,style:{width:"44px",height:"44px",marginLeft:"16px",borderRadius:"8px",backgroundColor:"#F5F5F5"},mode:"scaleToFill"})]}),Object(v["jsx"])(y["h"],{style:{height:"16px",fontWeight:400,fontSize:"12px",lineHeight:"16px",color:"#303030",opacity:"0.3"},children:"\u8bf7\u9009\u62e9 >"}),Object(v["jsx"])(y["a"],{openType:"chooseAvatar",onChooseAvatar:T,style:{position:"absolute",left:0,right:0,height:"44px",backgroundColor:"transparent"}})]}),Object(v["jsx"])(y["h"],{style:{marginTop:"14px",marginLeft:"24px",marginRight:"24px",height:"1px",backgroundColor:"#F5F5F5"}}),Object(v["jsxs"])(y["h"],{style:{marginTop:"14px",marginLeft:"24px",marginRight:"30px",height:"44px",display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(v["jsx"])(y["h"],{style:{height:"20px",fontWeight:400,fontSize:"14px",lineHeight:"20px",color:"#303030",display:"inline-block"},children:"\u6635\u79f0"}),Object(v["jsx"])(y["e"],{style:{fontWeight:600,fontSize:"14px",lineHeight:"22px",color:"#303030",marginLeft:"16px",marginRight:"0px",width:"260px",height:"44px"},type:"nickname",name:"nickname",placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0",placeholderStyle:"font-style: normal;font-weight: 400;font-size: 14px;line-height: 22px;color: rgba(48, 48, 48, 0.3);",value:F,onInput:function(e){return S(e.detail.value)}})]}),Object(v["jsx"])(y["h"],{style:{marginTop:"14px",marginLeft:"24px",marginRight:"24px",height:"1px",backgroundColor:"#F5F5F5"}}),Object(v["jsxs"])(y["h"],{style:{position:"absolute",left:0,right:0,bottom:0,margin:"108px auto",textAlign:"center",width:"172px",height:"108px"},children:[Object(v["jsx"])(y["a"],{style:{width:"172px",height:"46px",fontWeight:"600",fontSize:"14px",lineHeight:"20px",backgroundColor:"#00C25F",borderRadius:"8px",color:"white",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},formType:"submit",children:"\u786e\u8ba4"}),Object(v["jsx"])(y["h"],{style:{marginTop:"16px",width:"172px",height:"46px",fontWeight:"600",fontSize:"14px",lineHeight:"20px",backgroundColor:"#F2F2F2",borderRadius:"8px",color:"#00C25F",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},onClick:_,children:"\u53d6\u6d88"})]})]})},S=Object(p["a"])(F),C={navigationStyle:"custom",disableScroll:!0};Page(Object(o["createPageConfig"])(S,"components/PersonalInfoSettingComponent",{root:{cn:[]}},C||{})),t["default"]=S}},[[134,0,1,2,3]]]);