(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[3],{14:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i,o=n(10),r=n(11),s=n(3),a=n(4),c=n.n(a),u=function(){function e(){Object(o["a"])(this,e)}return Object(r["a"])(e,null,[{key:"getScreenHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=c.a.getSystemInfoSync();return e&&t.windowHeight===t.screenHeight?t.screenHeight-t.statusBarHeight-this.getWechatCustomNavigationBarHeight():t.windowHeight}},{key:"getWechatCustomNavigationBarHeight",value:function(){return"android"===this.platform?48:this.baseNavigationBarHeight}},{key:"isEnterpriseVersion",value:function(){return"wxwork"===this.systemInfo.environment&&!1}},{key:"getLoginFunc",value:function(){return this.isEnterpriseVersion()?c.a.qy.login:c.a.login}},{key:"getLoginGqlRootField",value:function(){return this.isEnterpriseVersion()?"loginWithWxworkMiniApp":"loginWithWechatMiniApp"}},{key:"getCheckSessionFunc",value:function(){return this.isEnterpriseVersion()?c.a.qy.checkSession:c.a.checkSession}}]),e}();i=u,Object(s["a"])(u,"baseScreenWidth",375),Object(s["a"])(u,"baseStatusBarHeight",20),Object(s["a"])(u,"baseNavigationBarHeight",44),Object(s["a"])(u,"baseTabBarHeight",49),Object(s["a"])(u,"systemInfo",c.a.getSystemInfoSync()),Object(s["a"])(u,"platform",i.systemInfo.platform),Object(s["a"])(u,"statusBarHeight",i.systemInfo.statusBarHeight),Object(s["a"])(u,"screenWidth",i.systemInfo.windowWidth),Object(s["a"])(u,"dpr",i.systemInfo.pixelRatio),Object(s["a"])(u,"ratio",i.screenWidth/i.baseScreenWidth)},26:function(e,t,n){"use strict";var i=n(10),o=n(11),r=n(3),s=n(4),a=n.n(s),c=n(40),u="LoginServiceAccountStorageKey",l="LoginServiceTokenStorageKey",h=function(){function e(){Object(i["a"])(this,e),Object(r["a"])(this,"account",void 0),Object(r["a"])(this,"token","eyJhbGciOiJIUzI1NiJ9.eyJkZWZhdWx0Um9sZSI6ImFub255bW91cyIsIlpFUk9fVVNFUl9JRCI6IjEwMDAwMDAwMDAwMDAwMDAiLCJyb2xlcyI6WyJhbm9ueW1vdXMiXSwiemVybyI6e30sImhhc3VyYV9jbGFpbXMiOnsieC1oYXN1cmEtYWxsb3dlZC1yb2xlcyI6WyJhbm9ueW1vdXMiXSwieC1oYXN1cmEtdXNlci1pZCI6IjEwMDAwMDAwMDAwMDAwMDAiLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJhbm9ueW1vdXMifX0.P9H5gt6JeAdLt98lJhRer7qmZEK5F7uhM7mRLDjhB2g");var t=a.a.getStorageSync(u);t&&(this.account=JSON.parse(t));var n=a.a.getStorageSync(l);n&&(this.token=n)}return Object(o["a"])(e,[{key:"isLoggedIn",value:function(){return this.getAccountId().length>0&&"1000000000000000"!==this.getAccountId()}},{key:"setAccount",value:function(e){this.account=e,e?a.a.setStorageSync(u,JSON.stringify(e)):a.a.removeStorageSync(u)}},{key:"setToken",value:function(e){this.token=e||"eyJhbGciOiJIUzI1NiJ9.eyJkZWZhdWx0Um9sZSI6ImFub255bW91cyIsIlpFUk9fVVNFUl9JRCI6IjEwMDAwMDAwMDAwMDAwMDAiLCJyb2xlcyI6WyJhbm9ueW1vdXMiXSwiemVybyI6e30sImhhc3VyYV9jbGFpbXMiOnsieC1oYXN1cmEtYWxsb3dlZC1yb2xlcyI6WyJhbm9ueW1vdXMiXSwieC1oYXN1cmEtdXNlci1pZCI6IjEwMDAwMDAwMDAwMDAwMDAiLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJhbm9ueW1vdXMifX0.P9H5gt6JeAdLt98lJhRer7qmZEK5F7uhM7mRLDjhB2g",e?a.a.setStorageSync(l,e):a.a.removeStorageSync(l)}},{key:"getAccountId",value:function(){var e=Object(c["d"])(this.account,["id"],"1000000000000000");return"number"===typeof e&&(e=JSON.stringify(e)),e}},{key:"getThirdPartyInfo",value:function(){return Object(c["d"])(this.account,["thirdPartyInfo"],{})}}]),e}(),d=new h;t["a"]=d},28:function(e,t,n){"use strict";var i=n(59),o=new i["EventEmitter2"]({wildcard:!0,delimiter:"::",newListener:!1,removeListener:!1,maxListeners:999,verboseMemoryLeak:!1,ignoreErrors:!1});t["a"]=o},32:function(e,t,n){"use strict";var i,o,r,s,a,c=n(23),u=n(11),l=n(10),h=(n(3),n(24)),d=(n(106),n(9)),v=(i=Object(u["a"])((function e(){Object(l["a"])(this,e),Object(c["a"])(this,"watermarkLottieUrl",o,this),Object(c["a"])(this,"watermarkVisibility",r,this),Object(c["a"])(this,"onPersonalInfoSettingSuccess",s,this),Object(c["a"])(this,"roleNames",a,this)})),o=Object(h["a"])(i.prototype,"watermarkLottieUrl",[d["l"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r=Object(h["a"])(i.prototype,"watermarkVisibility",[d["l"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=Object(h["a"])(i.prototype,"onPersonalInfoSettingSuccess",[d["l"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=Object(h["a"])(i.prototype,"roleNames",[d["l"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i);t["a"]=new v},36:function(e,t,n){"use strict";var i,o=n(5),r=n(13),s=n(15),a=n(91),c=n(30),u=n(90),l=n(96),h="https://zion-app.functorz.com/AxbbnoJvOVz/zero/rmLyJ0Z82gd/api/graphql-v2",d="wss://zion-app.functorz.com/AxbbnoJvOVz/zero/rmLyJ0Z82gd/api/graphql-subscription",v=n(26),f=n(12),b=n(28),y=n(9),m=n(4),O=n.n(m),p=n(58),g=n(27),k=n(10),j=n(11),w=n(3),T=n(69),I=n.n(T),E=n(86),C=n(61),M=n(88),S=n(60),N=n(65),A="graphql-ws",L=A,P=1e3,R=3e4,x=Object(j["a"])((function e(){Object(k["a"])(this,e)}));i=x,Object(w["a"])(x,"GQL_CONNECTION_INIT","connection_init"),Object(w["a"])(x,"GQL_CONNECTION_ACK","connection_ack"),Object(w["a"])(x,"GQL_CONNECTION_ERROR","connection_error"),Object(w["a"])(x,"GQL_CONNECTION_KEEP_ALIVE","ka"),Object(w["a"])(x,"GQL_CONNECTION_TERMINATE","connection_terminate"),Object(w["a"])(x,"GQL_START","start"),Object(w["a"])(x,"GQL_DATA","data"),Object(w["a"])(x,"GQL_ERROR","error"),Object(w["a"])(x,"GQL_COMPLETE","complete"),Object(w["a"])(x,"GQL_STOP","stop"),Object(w["a"])(x,"GQL_CONTROL_MESSAGE_TYPES",[i.GQL_CONNECTION_INIT,i.GQL_CONNECTION_TERMINATE]);var _=function(){function e(t,n,i,o){Object(k["a"])(this,e),Object(w["a"])(this,"client",void 0),Object(w["a"])(this,"operations",void 0),Object(w["a"])(this,"url",void 0),Object(w["a"])(this,"connectionAcked",void 0),Object(w["a"])(this,"nextOperationId",void 0),Object(w["a"])(this,"connectionParams",void 0),Object(w["a"])(this,"minWsTimeout",void 0),Object(w["a"])(this,"wsTimeout",void 0),Object(w["a"])(this,"unsentMessagesQueue",void 0),Object(w["a"])(this,"reconnect",void 0),Object(w["a"])(this,"reconnecting",void 0),Object(w["a"])(this,"reconnectionAttempts",void 0),Object(w["a"])(this,"backoff",void 0),Object(w["a"])(this,"connectionCallback",void 0),Object(w["a"])(this,"eventEmitter",void 0),Object(w["a"])(this,"lazy",void 0),Object(w["a"])(this,"inactivityTimeout",void 0),Object(w["a"])(this,"inactivityTimeoutId",void 0),Object(w["a"])(this,"closedByUser",void 0),Object(w["a"])(this,"wsImpl",void 0),Object(w["a"])(this,"wsProtocols",void 0),Object(w["a"])(this,"wasKeepAliveReceived",void 0),Object(w["a"])(this,"tryReconnectTimeoutId",void 0),Object(w["a"])(this,"checkConnectionIntervalId",void 0),Object(w["a"])(this,"maxConnectTimeoutId",void 0),Object(w["a"])(this,"middlewares",void 0),Object(w["a"])(this,"maxConnectTimeGenerator",void 0),Object(w["a"])(this,"wsOptionArguments",void 0);var r=n||{},s=r.connectionCallback,a=void 0===s?void 0:s,c=r.connectionParams,u=void 0===c?{}:c,l=r.minTimeout,h=void 0===l?P:l,d=r.timeout,v=void 0===d?R:d,f=r.reconnect,b=void 0!==f&&f,y=r.reconnectionAttempts,m=void 0===y?1/0:y,O=r.lazy,p=void 0!==O&&O,g=r.inactivityTimeout,j=void 0===g?0:g,T=r.wsOptionArguments,C=void 0===T?[]:T;if(this.wsImpl=i,!this.wsImpl)throw new Error("must provide wsImpl");this.wsProtocols=o||L,this.connectionCallback=a,this.url=t,this.connectionAcked=!1,this.operations={},this.nextOperationId=0,this.minWsTimeout=h,this.wsTimeout=v,this.unsentMessagesQueue=[],this.reconnect=b,this.reconnecting=!1,this.reconnectionAttempts=m,this.lazy=!!p,this.inactivityTimeout=j,this.closedByUser=!1,this.backoff=new I.a({jitter:.5}),this.eventEmitter=new E["EventEmitter"],this.middlewares=[],this.client=null,this.maxConnectTimeGenerator=this.createMaxConnectTimeGenerator(),this.connectionParams=this.getConnectionParams(u),this.wsOptionArguments=C,this.lazy||this.connect()}return Object(j["a"])(e,[{key:"status",get:function(){return null===this.client?this.wsImpl.CLOSED:this.client.readyState}},{key:"close",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clearInactivityTimeout(),null!==this.client&&(this.closedByUser=t,e&&(this.clearCheckConnectionInterval(),this.clearMaxConnectTimeout(),this.clearTryReconnectTimeout(),this.unsubscribeAll(),this.sendMessage(void 0,x.GQL_CONNECTION_TERMINATE,null)),this.client.close(),this.client.onopen=null,this.client.onclose=null,this.client.onerror=null,this.client.onmessage=null,this.client=null,this.connectionAcked=!1,this.eventEmitter.emit("disconnected"),e||this.tryReconnect())}},{key:"request",value:function(e){var t,n,i=this.getObserver.bind(this),o=this.executeOperation.bind(this),r=this.unsubscribe.bind(this);return this.clearInactivityTimeout(),t={},Object(w["a"])(t,S["a"],(function(){return this})),Object(w["a"])(t,"subscribe",(function(t,s,a){var c=i(t,s,a);return n=o(e,(function(e,t){null===e&&null===t?c.complete&&c.complete():e?c.error&&c.error(e[0]):c.next&&c.next(t)})),{unsubscribe:function(){n&&(r(n),n=null)}}})),t}},{key:"on",value:function(e,t,n){var i=this.eventEmitter.on(e,t,n);return function(){i.off(e,t,n)}}},{key:"onConnected",value:function(e,t){return this.on("connected",e,t)}},{key:"onConnecting",value:function(e,t){return this.on("connecting",e,t)}},{key:"onDisconnected",value:function(e,t){return this.on("disconnected",e,t)}},{key:"onReconnected",value:function(e,t){return this.on("reconnected",e,t)}},{key:"onReconnecting",value:function(e,t){return this.on("reconnecting",e,t)}},{key:"onError",value:function(e,t){return this.on("error",e,t)}},{key:"unsubscribeAll",value:function(){var e=this;Object.keys(this.operations).forEach((function(t){e.unsubscribe(t)}))}},{key:"applyMiddlewares",value:function(e){var t=this;return new Promise((function(n,i){var o=function(t,o){var r=function r(s){if(s)i(s);else if(t.length>0){var a=t.shift();a&&a.applyMiddleware.apply(o,[e,r])}else n(e)};r()};o(Object(g["a"])(t.middlewares),t)}))}},{key:"use",value:function(e){var t=this;return e.forEach((function(e){if("function"!==typeof e.applyMiddleware)throw new Error("Middleware must implement the applyMiddleware function.");t.middlewares.push(e)})),this}},{key:"getConnectionParams",value:function(e){return function(){return new Promise((function(t,n){if("function"===typeof e)try{return t(e.call(null))}catch(e){return n(e)}t(e)}))}}},{key:"executeOperation",value:function(e,t){var n=this;null===this.client&&this.connect();var i=this.generateOperationId();return this.operations[i]={options:e,handler:t},this.applyMiddlewares(e).then((function(e){n.checkOperationOptions(e,t),n.operations[i]&&(n.operations[i]={options:e,handler:t},n.sendMessage(i,x.GQL_START,e))})).catch((function(e){n.unsubscribe(i),t(n.formatErrors(e))})),i}},{key:"getObserver",value:function(e,t,n){return"function"===typeof e?{next:function(t){return e(t)},error:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return t&&t(e)})),complete:function(){return n&&n()}}:e}},{key:"createMaxConnectTimeGenerator",value:function(){var e=this.minWsTimeout,t=this.wsTimeout;return new I.a({min:e,max:t,factor:1.2})}},{key:"clearCheckConnectionInterval",value:function(){this.checkConnectionIntervalId&&(clearInterval(this.checkConnectionIntervalId),this.checkConnectionIntervalId=null)}},{key:"clearMaxConnectTimeout",value:function(){this.maxConnectTimeoutId&&(clearTimeout(this.maxConnectTimeoutId),this.maxConnectTimeoutId=null)}},{key:"clearTryReconnectTimeout",value:function(){this.tryReconnectTimeoutId&&(clearTimeout(this.tryReconnectTimeoutId),this.tryReconnectTimeoutId=null)}},{key:"clearInactivityTimeout",value:function(){this.inactivityTimeoutId&&(clearTimeout(this.inactivityTimeoutId),this.inactivityTimeoutId=null)}},{key:"setInactivityTimeout",value:function(){var e=this;this.inactivityTimeout>0&&0===Object.keys(this.operations).length&&(this.inactivityTimeoutId=setTimeout((function(){0===Object.keys(e.operations).length&&e.close()}),this.inactivityTimeout))}},{key:"checkOperationOptions",value:function(e,t){var n=e.query,i=e.variables,o=e.operationName;if(!n)throw new Error("Must provide a query.");if(!t)throw new Error("Must provide an handler.");if(!Object(N["b"])(n)&&!Object(M["getOperationAST"])(n,o)||o&&!Object(N["b"])(o)||i&&!Object(N["a"])(i))throw new Error("Incorrect option types. query must be a string or a document,`operationName` must be a string, and `variables` must be an object.")}},{key:"buildMessage",value:function(e,t,n){var i=n&&n.query?Object(s["a"])(Object(s["a"])({},n),{},{query:"string"===typeof n.query?n.query:Object(C["print"])(n.query)}):n;return{id:e,type:t,payload:i}}},{key:"formatErrors",value:function(e){return Array.isArray(e)?e:e&&e.errors?this.formatErrors(e.errors):e&&e.message?[e]:[{name:"FormatedError",message:"Unknown error",originalError:e}]}},{key:"sendMessage",value:function(e,t,n){this.sendMessageRaw(this.buildMessage(e,t,n),this.isApolloControlMessageType(t))}},{key:"sendMessageRaw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this.status){case this.wsImpl.OPEN:if(t||this.connectionAcked){var n=JSON.stringify(e);this.client.send(n)}else this.unsentMessagesQueue.push(e);break;case this.wsImpl.CONNECTING:this.unsentMessagesQueue.push(e);break;default:this.reconnecting||this.eventEmitter.emit("error",new Error("".concat("A message was not sent because socket is not connected, is closing or is already closed. Message was: ").concat(JSON.stringify(e))))}}},{key:"isApolloControlMessageType",value:function(e){return x.GQL_CONTROL_MESSAGE_TYPES.includes(e)}},{key:"generateOperationId",value:function(){return String(++this.nextOperationId)}},{key:"tryReconnect",value:function(){var e=this;if(this.reconnect&&!(this.backoff.attempts>=this.reconnectionAttempts)){this.reconnecting||(Object.keys(this.operations).forEach((function(t){e.unsentMessagesQueue.push(e.buildMessage(t,x.GQL_START,e.operations[t].options))})),this.reconnecting=!0,this.connectionAcked=!1),this.clearTryReconnectTimeout();var t=this.backoff.duration();this.tryReconnectTimeoutId=setTimeout((function(){e.connect()}),t)}}},{key:"flushUnsentMessagesQueue",value:function(){var e=this;this.unsentMessagesQueue.forEach((function(t){e.sendMessageRaw(t)})),this.unsentMessagesQueue=[]}},{key:"checkConnection",value:function(){this.wasKeepAliveReceived?this.wasKeepAliveReceived=!1:this.reconnecting||this.close(!1,!0)}},{key:"checkMaxConnectTimeout",value:function(){var e=this;this.clearMaxConnectTimeout(),this.maxConnectTimeoutId=setTimeout((function(){e.status!==e.wsImpl.OPEN&&(e.reconnecting=!0,e.close(!1,!0))}),this.maxConnectTimeGenerator.duration())}},{key:"connect",value:function(){var e=this;this.client=Object(p["a"])(this.wsImpl,[this.url,this.wsProtocols].concat(Object(g["a"])(this.wsOptionArguments))),this.connectionAcked=!1,this.checkMaxConnectTimeout(),this.client.onopen=Object(r["a"])(Object(o["a"])().mark((function t(){var n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("subscription client onopen",e.client.socketTaskId),e.status!==e.wsImpl.OPEN){t.next=16;break}return e.clearMaxConnectTimeout(),e.closedByUser=!1,e.eventEmitter.emit(e.reconnecting?"reconnecting":"connecting"),t.prev=5,t.next=8,e.connectionParams();case 8:n=t.sent,e.sendMessage(void 0,x.GQL_CONNECTION_INIT,n),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](5),e.sendMessage(void 0,x.GQL_CONNECTION_ERROR,t.t0),e.flushUnsentMessagesQueue();case 16:case"end":return t.stop()}}),t,null,[[5,12]])}))),this.client.onclose=function(){e.closedByUser||e.close(!1,!1)},this.client.onerror=function(t){e.eventEmitter.emit("error",t)},this.client.onmessage=function(t){var n=t.data;e.processReceivedData(n)}}},{key:"processReceivedData",value:function(e){var t,n;try{t=JSON.parse(e),n=t.id}catch(t){throw new Error("Message must be JSON-parseable. Got: ".concat(e))}if(-1===[x.GQL_DATA,x.GQL_COMPLETE,x.GQL_ERROR].indexOf(t.type)||this.operations[n])switch(t.type){case x.GQL_CONNECTION_ERROR:this.connectionAcked=!1,this.connectionCallback&&this.connectionCallback(t.payload);break;case x.GQL_CONNECTION_ACK:this.eventEmitter.emit(this.reconnecting?"reconnected":"connected",t.payload),this.reconnecting=!1,this.backoff.reset(),this.maxConnectTimeGenerator.reset(),this.connectionAcked=!0,this.flushUnsentMessagesQueue(),this.connectionCallback&&this.connectionCallback();break;case x.GQL_COMPLETE:var i=this.operations[n].handler;delete this.operations[n],i.call(this,null,null);break;case x.GQL_ERROR:this.operations[n].handler(this.formatErrors(t.payload),null),delete this.operations[n];break;case x.GQL_DATA:var o=t.payload.errors?Object(s["a"])(Object(s["a"])({},t.payload),{},{errors:this.formatErrors(t.payload.errors)}):t.payload;this.operations[n].handler(null,o);break;case x.GQL_CONNECTION_KEEP_ALIVE:var r="undefined"===typeof this.wasKeepAliveReceived;this.wasKeepAliveReceived=!0,r&&this.checkConnection(),this.checkConnectionIntervalId&&(clearInterval(this.checkConnectionIntervalId),this.checkConnection()),this.checkConnectionIntervalId=setInterval(this.checkConnection.bind(this),this.wsTimeout);break;default:throw new Error("Invalid message type!")}else this.unsubscribe(n)}},{key:"unsubscribe",value:function(e){this.operations[e]&&(delete this.operations[e],this.setInactivityTimeout(),this.sendMessage(e,x.GQL_STOP,void 0))}}]),e}(),G=n(7),J=n(19),Q=n(20),q=n(59),W=1,B=function(e){Object(J["a"])(n,e);var t=Object(Q["a"])(n);function n(e,i){var o;Object(k["a"])(this,n),o=t.call(this),Object(w["a"])(Object(G["a"])(o),"protocol",void 0),Object(w["a"])(Object(G["a"])(o),"url",void 0),Object(w["a"])(Object(G["a"])(o),"binaryType",void 0),Object(w["a"])(Object(G["a"])(o),"bufferedAmount",void 0),Object(w["a"])(Object(G["a"])(o),"extensions",void 0),Object(w["a"])(Object(G["a"])(o),"socketTask",void 0),Object(w["a"])(Object(G["a"])(o),"socketTaskId",void 0),Object(w["a"])(Object(G["a"])(o),"listenersByType",void 0),o.url=e,o.protocol="graphql-ws",o.extensions="",o.binaryType="blob",o.listenersByType=new Map;var r={url:o.url,protocols:[o.protocol],success:function(e){console.log("connected",e),o.socketTaskId=e.socketTaskId;var t=o.listenersByType.get("open");null===t||void 0===t||t.forEach((function(t){return t(e)}))}};return o.socketTask=wx.connectSocket(r),o.socketTask.onClose((function(e){console.log("onClose",o.socketTaskId,o.socketTask.readyState);var t=o.listenersByType.get("close");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),o.socketTask.onError((function(e){console.log("error",o.socketTaskId,o.socketTask.readyState,e);var t=o.listenersByType.get("error");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),o.socketTask.onMessage((function(e){var t=o.listenersByType.get("message");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),o.socketTask.onOpen((function(e){console.log("opened",o.socketTaskId,o.socketTask.readyState,e);var t=o.listenersByType.get("open");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),o}return Object(j["a"])(n,[{key:"CLOSED",get:function(){return 3}},{key:"CLOSING",get:function(){return 2}},{key:"CONNECTING",get:function(){return 0}},{key:"OPEN",get:function(){return 1}},{key:"readyState",get:function(){return this.socketTask.readyState}},{key:"dispatchEvent",value:function(e){throw new Error("Method not implemented.")}},{key:"onclose",get:function(){throw new Error("Method not implemented.")},set:function(e){e?this.listenersByType.set("close",new Set([e])):this.listenersByType.delete("close")}},{key:"onerror",get:function(){throw new Error("Method not implemented.")},set:function(e){e?this.listenersByType.set("error",new Set([e])):this.listenersByType.delete("error")}},{key:"onmessage",get:function(){throw new Error("Method not implemented.")},set:function(e){e?this.listenersByType.set("message",new Set([e])):this.listenersByType.delete("message")}},{key:"onopen",get:function(){throw new Error("Method not implemented.")},set:function(e){e?(this.listenersByType.set("open",new Set([e])),this.readyState===W&&e.apply(this)):this.listenersByType.delete("open")}},{key:"ping",value:function(e,t,n){console.log("ping",e,t,n)}},{key:"pong",value:function(e,t,n){console.log("pong",e,t,n)}},{key:"close",value:function(e,t){var n=this;console.log("closing ws",this.socketTaskId,this.socketTask.readyState),this.socketTask.close({code:e,reason:t,success:function(e){console.log("ws closing success",n.socketTaskId,n.readyState,e)},fail:function(e){console.log("ws closing error",n.socketTaskId,n.readyState,e)}})}},{key:"send",value:function(e){e.toString().indexOf("subscription")>=0?console.log("send subscription message",this.socketTaskId,this.socketTask.readyState,e):console.log("send",this.socketTaskId,this.socketTask.readyState,e);var t=e;this.socketTask.send({data:t})}},{key:"addEventListener",value:function(e,t,n){console.log("addEventListener",e,t);var i=this.listenersByType.get(e);i||(i=new Set),i.add(t)}},{key:"removeEventListener",value:function(e,t,n){var i=this.listenersByType.get(e);i?i.delete(t):i=new Set}}]),n}(q["EventEmitter2"]);Object(w["a"])(B,"CLOSED",3),Object(w["a"])(B,"CLOSING",2),Object(w["a"])(B,"CONNECTING",0),Object(w["a"])(B,"OPEN",1);var D,U,X=function(e){Object(J["a"])(n,e);var t=Object(Q["a"])(n);function n(e){var i;return Object(k["a"])(this,n),i=t.call(this),Object(w["a"])(Object(G["a"])(i),"subscriptionClient",void 0),i.subscriptionClient=e,i}return Object(j["a"])(n,[{key:"request",value:function(e){return this.subscriptionClient.request(e)}}]),n}(c["a"]),F=n(14),V=new c["a"]((function(e,t){return e.setContext((function(e){var t=e.headers||[];return{headers:Object(s["a"])(Object(s["a"])({},t),{},{Authorization:"Bearer "+v["a"].token})}})),t(e)})),z=function(e,t){var n=t.body,i=t.method,o=t.headers;return new Promise((function(t){return O.a.request({url:e,header:o,method:i,data:n,dataType:"text",complete:function(r){var s=r.data,a=r.statusCode;r.errMsg;t({ok:function(){return a>=200&&a<300},statusText:JSON.stringify({url:e,headers:o,method:i,body:n,result:r}),text:function(){return Promise.resolve(s)}})}})}))},Z=Object(c["c"])([V,new u["a"]({uri:h,fetch:z})]),H=new _(d,{lazy:!0,reconnect:!0,connectionParams:function(){var e={Authorization:"Bearer "+v["a"].token};return{authToken:v["a"].token,headers:e}}},B);b["a"].on("GLOBAL_REFRESH",(function(){return H.close()}));var K=new X(H),Y=Object(c["e"])((function(e){var t=e.query,n=Object(f["j"])(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),K,Z),$=new a["a"]({link:Y,cache:new l["a"],defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"ignore"},query:{fetchPolicy:"no-cache",errorPolicy:"all"}}}),ee=function(e,t){return(D=D||Object(r["a"])(Object(o["a"])().mark((function e(t,n){var i,a,c,u,l,h;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("result ->",t),i=n.handlerParams,a=n.onSuccess,c=n.onFailure,u=n.onFinally,l=n.onShowToast,h=n.onRequestStatusChange,Object(y["o"])(Object(r["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.errors&&t.errors.length){null===h||void 0===h||h("business-error");try{null===c||void 0===c||c()}finally{null===u||void 0===u||u()}null===l||void 0===l||l(t.errors.map((function(e){return e.message})).join("\n")),ne(Object(s["a"])(Object(s["a"])({},i),{},{errorMessage:t.errors.map((function(e){return e.message})).join("\n")}))}else if(t.data){null===h||void 0===h||h("successful");try{null===a||void 0===a||a(t)}finally{null===u||void 0===u||u()}}else{null===h||void 0===h||h("business-error");try{null===c||void 0===c||c()}finally{null===u||void 0===u||u()}null===l||void 0===l||l(error.message||"unknown error"),ne(Object(s["a"])(Object(s["a"])({},i),{},{errorMessage:error.message||"unknown error"}))}case 1:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},te=function(e,t){return(U=U||Object(r["a"])(Object(o["a"])().mark((function e(t,n){var i,r,a,c,u;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("error ->",t),i=n.handlerParams,r=n.onFailure,a=n.onFinally,c=n.onShowToast,u=n.onRequestStatusChange,t.graphQLErrors&&t.graphQLErrors.length){null===u||void 0===u||u("business-error");try{null===r||void 0===r||r()}finally{null===a||void 0===a||a()}null===c||void 0===c||c(t.graphQLErrors.map((function(e){return e.message})).join("\n")),ne(Object(s["a"])(Object(s["a"])({},i),{},{errorMessage:t.graphQLErrors.map((function(e){return e.message})).join("\n")}))}else if(t.networkError&&"ServerParseError"===t.networkError.name){null===u||void 0===u||u("network-error");try{null===r||void 0===r||r()}finally{null===a||void 0===a||a()}null===c||void 0===c||c("network error"),ne(Object(s["a"])(Object(s["a"])({},i),{},{errorMessage:JSON.stringify(t)}))}else{null===u||void 0===u||u("network-error");try{null===r||void 0===r||r()}finally{null===a||void 0===a||a()}null===c||void 0===c||c(t.message||"unknown error"),ne(Object(s["a"])(Object(s["a"])({},i),{},{errorMessage:JSON.stringify(t)}))}case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},ne=function(e){O.a.request({url:"https://error-collector.functorz.com/add/project_error_log",method:"POST",header:{"Content-Type":"application/json","x-project-auth":"rmLyJ0Z82gd"},data:{projectExId:"rmLyJ0Z82gd",stage:"RUNTIME",interactiveType:"RUNTIME",platform:"WECHAT_MINIPROGRAM",message:e.errorMessage,detail:{url:e.url,gql:oe(e.gql),variable:e.variables||{},account:v["a"].account,appVersion:"v23111401",systemInfo:F["a"].systemInfo}}})},ie={query:function(e,t){return $.query(e).then((function(n){return ee(n,Object(s["a"])(Object(s["a"])({},t),{},{handlerParams:{url:h,gql:e.query}}))}),(function(n){return te(n,Object(s["a"])(Object(s["a"])({},t),{},{handlerParams:{url:h,gql:e.query}}))}))},subscribe:function(e,t){return $.subscribe(e).subscribe((function(n){return ee(n,Object(s["a"])(Object(s["a"])({},t),{},{handlerParams:{url:d,gql:e.query}}))}),(function(n){return te(n,Object(s["a"])(Object(s["a"])({},t),{},{handlerParams:{url:d,gql:e.query}}))}))},mutate:function(e,t){return $.mutate(e).then((function(n){return ee(n,Object(s["a"])(Object(s["a"])({},t),{},{handlerParams:{url:h,gql:e.mutation,variables:e.variables}}))}),(function(n){return te(n,Object(s["a"])(Object(s["a"])({},t),{},{handlerParams:{url:h,gql:e.mutation,variables:e.variables}}))}))}},oe=(t["a"]=ie,function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.loc)||void 0===n||null===(n=n.source)||void 0===n?void 0:n.body)&&void 0!==t?t:"gql parse failed"})},37:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(11),o=n(10),r=n(3),s=Object(i["a"])((function e(){Object(o["a"])(this,e)}));Object(r["a"])(s,"launchArgs",{}),Object(r["a"])(s,"screenData",{}),Object(r["a"])(s,"audioData",{}),Object(r["a"])(s,"uploadPromises",{}),Object(r["a"])(s,"requestStatus",{})},40:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));n(5),n(13),n(25),n(21),n(43),n(33),n(49),n(37);var i=function(e){return null===e||void 0===e},o=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(null===t||void 0===t)return i;if(n.length>o){var r=n[o];return null==r||void 0===r?i:e(t[r],n,i,o+1)}return t},r=function(e){try{return JSON.parse(e)}catch(e){return}},s=function(e,t,n,o){return"FZ_QUERY_NULL_EXP_FZ"===n||o&&i(n)?"{".concat(e,": { ").concat(t,": null }}"):i(n)?"{}":"{".concat(e,": { ").concat(t,": ").concat(JSON.stringify(n)," }}")},a=function(e){return e.value},c=function(e){return"string"===typeof e?e:null===e||void 0===e?void 0:e.url}},63:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i,o=n(27),r=n(5),s=n(13),a=n(34),c=n(95),u=n.n(c),l=n(4),h=n.n(l),d=n(35),v=n.n(d),f=n(36),b=function(e){return h.a.arrayBufferToBase64(u()(e))},y=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=b(n);return new Promise((function(n,u){var l,d;o&&h.a.showLoading({title:"",mask:!0});var b=function(){o&&h.a.hideLoading()},y=v()(i||(i=Object(a["a"])(['\n              mutation ImagePresignedUrl {\n                imagePresignedUrl(imgMd5Base64: "','", imageSuffix: ',") {\n                  uploadUrl\n                  downloadUrl\n                  contentType\n                  imageId\n                }\n              }\n            "])),c,t);f["a"].mutate({mutation:y,variables:{}},{onSuccess:function(t){return(l=l||Object(s["a"])(Object(r["a"])().mark((function t(i){var o,s,a,l,d;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=i.data.imagePresignedUrl,s=o.uploadUrl,a=o.downloadUrl,l=o.contentType,d=o.imageId,h.a.getFileSystemManager().readFile({filePath:e,success:function(e){h.a.request({url:s,timeout:18e4,header:{"Content-Type":l,"Content-MD5":c},method:"PUT",data:e.data,success:function(e){console.log(e),b(),n({id:d,url:a})},fail:function(e){console.log(e),b(),u(null),h.a.showToast({title:"".concat(e.errMsg),duration:1500,icon:"none"})}})},fail:function(e){console.log(e),b(),u(null),h.a.showToast({title:"".concat(e.errMsg),duration:1500,icon:"none"})}});case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},onFailure:function(){return(d=d||Object(s["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:b(),u(null);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onShowToast:function(e){h.a.showToast({title:"".concat(e),duration:1500,icon:"none"})}})}))},m=["CSS","DOC","DOCX","GIF","HTML","JPEG","JPG","JSON","MOV","MP3","MP4","OTHER","PDF","PNG","WEBP","PPT","PPTX","TXT","WAV","XLS","XLSX","XML"];[].concat(m,Object(o["a"])(m.map((function(e){return e.toLowerCase()}))))}}]);